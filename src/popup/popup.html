<!DOCTYPE html>
<html>

<head>
    <title>HarnessNation+</title>
    <link href="/public/fonts/Roboto.css" rel="stylesheet" />
    <link href="/public/fonts/MaterialSymbolsOutlined.css" rel="stylesheet" />
    <link href="popup.css" rel="stylesheet" />
    <script type="module" src="/public/components/tooltip.js"></script>
    <script type="module" src="/public/components/catalog-creator.js"></script>
</head>

<body>
    <header id="page-header">
        <h1>HarnessNation<span style="color:var(--hn-plus-theme-secondary)">+</span></h1>
    </header>

    <main id="page-content">
        <section id="panel-stallion-settings" class="active">
            <details open>
                <summary>
                    <h2>Stallion Management</h2>
                </summary>

                <p>
                    Use the settings below to update your stallion management feature settings.
                </p>

                <div class="input-row">
                    <strong>
                        Stud Fee Formula
                        <a href="#stud-fee-formula-info" role="dialog">
                            <span class="material-symbols-outlined">help</span>
                        </a>
                    </strong>

                    <select name="settings.stallions.management.formula"></select>
                </div>

                <dialog id="stud-fee-formula-info">
                    <p>
                        The stud fee calculator breaks its calculations down into two formulas: without racing
                        offspring, and with racing offspring.
                        The table below details the available formula sets.
                    </p>

                    <h4>Apex Formula Set</h4>
                    <ul>
                        <li>
                            If the stud has racing offspring:<br />
                            <code style="white-space:nowrap">[average earanings per starter] / 4</code>
                        </li>

                        <li>
                            If the stud does not have racing offspring:<br />
                            <code style="white-space:nowrap">[lifetime earnings] / [lifetime starts]</code>
                        </li>
                    </ul>

                    <h4>Ridge Formula Set</h4>
                    <ul>
                        <li>
                            If the stud has racing offspring:<br />
                            <code style="white-space:nowrap">5000 + ([average earanings per starter] / 2)</code>
                        </li>

                        <li>
                            If the stud does not have racing offspring:<br />
                            <code style="white-space:nowrap">5000 + ([lifetime earnings] / 20)</code>
                        </li>
                    </ul>
                </dialog>
            </details>

            <details open>
                <summary>
                    <h2>Stallion Registry</h2>
                </summary>

                <p>
                    Use the settings below to update your stallion registry feature settings.
                </p>

                <div class="input-row">
                    <strong>
                        Use Bloodline Search
                        <a href="#bloodline-search-info" role="dialog">
                            <span class="material-symbols-outlined">help</span>
                        </a>
                    </strong>

                    <input data-initializing name="settings.stallions.registry.bloodlineSearch" role="toggle"
                        type="checkbox" />
                </div>

                <dialog id="bloodline-search-info">
                    <p>
                        Use this option to enable bloodline searching in the public stallion registry. This will allow
                        you to search for an ancestor in the stallion's sire line.
                    </p>

                    <p>
                        For example, searching for "Just Call Me Sparky" will match him, his sons, his sons' sons, and
                        so on.
                    </p>
                </dialog>

                <div class="input-row">
                    <strong>
                        Max Depth
                        <a href="#bloodline-search-max-depth-info" role="dialog">
                            <span class="material-symbols-outlined">help</span>
                        </a>
                    </strong>

                    <select name="settings.stallions.registry.maxGenerations">
                        <option>2</option>
                        <option>3</option>
                        <option>4</option>
                        <option>5</option>
                    </select>
                </div>

                <dialog id="bloodline-search-max-depth-info">
                    <p>
                        Defines the maximum number of generations to traverse in the bloodline search.
                    </p>
                </dialog>
            </details>
        </section>

        <section id="panel-table-settings">
            <details open>
                <summary>
                    <h2>Main Stable</h2>
                </summary>

                <p>
                    Use the settings below to control how the table options are stored on your main stable page.
                </p>

                <div class="input-row">
                    <strong>
                        Save Settings
                    </strong>

                    <input data-initializing name="settings.dt.main.enabled" role="toggle" type="checkbox" />
                </div>

                <div class="input-row">
                    <strong>
                        Duration
                    </strong>

                    <div class="save-duration">
                        <select name="settings.dt.main.mode"></select>
                        <input min="0" name="settings.dt.main.duration" type="number" />
                        <select name="settings.dt.main.displayUnits"></select>
                    </div>
                </div>
            </details>

            <details open>
                <summary>
                    <h2>Breeding Stable</h2>
                </summary>

                <p>
                    Use the settings below to control how the table options are stored on your breeding stable page.
                </p>

                <div class="input-row">
                    <strong>
                        Save Settings
                    </strong>

                    <input data-initializing name="settings.dt.breeding.enabled" role="toggle" type="checkbox" />
                </div>

                <div class="input-row">
                    <strong>
                        Duration
                    </strong>

                    <div class="save-duration">
                        <select name="settings.dt.breeding.mode"></select>
                        <input min="0" name="settings.dt.breeding.duration" type="number" />
                        <select name="settings.dt.breeding.displayUnits"></select>
                    </div>
                </div>
            </details>

            <details open>
                <summary>
                    <h2>Horse Progeny</h2>
                </summary>

                <p>
                    Use the settings below to control how the table options are stored for the stallion and broodmare
                    progeny popups.
                </p>

                <div class="input-row">
                    <strong>
                        Save Settings
                    </strong>

                    <input data-initializing name="settings.dt.progeny.enabled" role="toggle" type="checkbox" />
                </div>

                <div class="input-row">
                    <strong>
                        Duration
                    </strong>

                    <div class="save-duration">
                        <select name="settings.dt.progeny.mode"></select>
                        <input min="0" name="settings.dt.progeny.duration" type="number" />
                        <select name="settings.dt.progeny.displayUnits"></select>
                    </div>
                </div>
            </details>
        </section>

        <section id="panel-pedigree-pages">
            <section>
                <header>
                    <h2>Pedigree Catalog</h2>
                </header>

                <p>Fill out the form below to generate your pedigree catalog.</p>

                <hn-plus-catalog-creator></hn-plus-catalog-creator>
            </section>
        </section>

        <section id="panel-extension-settings">
            <details open>
                <summary>
                    <h2>Extension Settings</h2>
                </summary>

                <p>
                    To reset your extensions to their defaults, click the button below.
                </p>

                <section class="actions" style="text-align:center">
                    <button name="reset-settings" type="button">
                        <span class="material-symbols-outlined">delete_sweep</span>
                        Reset All Settings
                    </button>
                </section>
            </details>

            <details open>
                <summary>
                    <h2>Caches</h2>
                </summary>

                <h3>Stallion Cache</h3>

                <p>
                    If the bloodline search or stallion scores don't seem to be working property, use the button
                    below to clear the stallion cache. This will force HarnessNation+ to reload the cache from it's
                    database.
                </p>

                <section class="actions" style="text-align:center">
                    <button name="clear-stallion-cache" type="button">
                        <span class="material-symbols-outlined">cached</span>
                        Clear Stallion Cache
                    </button>
                </section>

                <hr />

                <h3>API Cache</h3>

                <p>
                    If data coming from HarnessNation seems to be out of sync, click the button below to clear the
                    API cache. This will force new requests to fetch data from HarnessNation.
                </p>

                <section class="actions" style="text-align:center">
                    <button name="clear-response-cache" type="button">
                        <span class="material-symbols-outlined">cached</span>
                        Clear API Cache
                    </button>
                </section>
            </details>
        </section>
    </main>

    <footer id="page-footer">
        <nav>
            <a class="active" href="#stallion-settings">
                <span class="material-symbols-outlined">warehouse</span>
                <span>Stallions</span>
            </a>

            <a href="#table-settings">
                <span class="material-symbols-outlined">table</span>
                <span>Tables</span>
            </a>

            <a href="#pedigree-pages">
                <span class="material-symbols-outlined">family_history</span>
                <span>Pedigree</span>
            </a>

            <a href="#extension-settings">
                <span class="material-symbols-outlined">settings</span>
                <span>Settings</span>
            </a>
        </nav>
    </footer>

    <script type="module" src="popup.js"></script>
</body>

</html>